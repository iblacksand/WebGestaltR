<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Performs site weighted gene set enrichment analysis or standard GSEA when
likelihood/weight columns in input_df are 1 or 0, p=1,
q=1 and thresh_type="val".'><title>Site Weighted Gene Set Enrichment Analysis — swGsea • WebGestaltR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Site Weighted Gene Set Enrichment Analysis — swGsea"><meta property="og:description" content='Performs site weighted gene set enrichment analysis or standard GSEA when
likelihood/weight columns in input_df are 1 or 0, p=1,
q=1 and thresh_type="val".'><meta property="og:image" content="https://iblacksand.github.io/WebGestaltR/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">WebGestaltR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Installation.html">Installation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bzhanglab/WebGestaltR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Site Weighted Gene Set Enrichment Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/bzhanglab/WebGestaltR/blob/HEAD/R/swGsea.R" class="external-link"><code>R/swGsea.R</code></a></small>
      <div class="d-none name"><code>swGsea.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs site weighted gene set enrichment analysis or standard GSEA when
likelihood/weight columns in <code>input_df</code> are 1 or 0, <code>p=1</code>,
<code>q=1</code> and <code>thresh_type="val"</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">swGsea</span><span class="op">(</span></span>
<span>  <span class="va">input_df</span>,</span>
<span>  thresh_type <span class="op">=</span> <span class="st">"percentile"</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  thresh_action <span class="op">=</span> <span class="st">"exclude"</span>,</span>
<span>  min_set_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_set_size <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  max_score <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  min_score <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>  psuedocount <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  perms <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  q <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nThreads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rng_seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fork <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>input_df</dt>
<dd><p>A data frame in which first column is name of item of interest
(gene, protein, phosphosite, etc.), the second is the correlation of that item
of interest with the phenotype (typically log ratio of expression for phenotype
vs. normal), and the remaining columns are the scores for the likelihood that
the item belongs in each set (one column per set).</p></dd>


<dt>thresh_type</dt>
<dd><p>The type of <code>thresh</code>. Use 'percentile' to include all
scores over that percentile given in <code>thresh</code> (i.e., 0.9 would be all items
in 90th percentile, or top 10 percent); 'list' to include a list of set lists
where the set lists are in the same order as the corresponding set columns in
the <code>input_df</code>; 'val' to apply a single threshold value to all sets; or
'values' to use a vector of unique cutoffs for each set (needs to be in the
same order as the sets are specified in the columns of <code>input_df</code>")</p></dd>


<dt>thresh</dt>
<dd><p>Depends on <code>thresh_type</code>. A list of lists of the items in
each set (with same names as colnames of the scores); a numeric vector of
threshold scores for each set (in the same order as the colnames of the scores
in the input_df), or a single percentile value between 0 and 1 (i.e., if
<code>thresh</code>=0.9, the 90th percentile of the score or the highest scoring 10<!-- % -->
of of the items are included in the set for each scoring regimen) (<code>thresh</code>
="all" is not supported at this time, as it doesn't result in a Kolgorov-Smirnoff
statistic; this may be worked in as an alternate scoring method later on).</p></dd>


<dt>thresh_action</dt>
<dd><p>Either "include", "exclude (default)", or "adjust";
this specifies how to treat each set if it doesn't contain a minimum number of
items or contains all of the items; this option cannot be used with predefined
lists of items in sets (if the number of items in a given set doesn't meet
requirements, that set will be skipped).</p></dd>


<dt>min_set_size, max_set_size</dt>
<dd><p>The minimum/maximum number of items each
set needs for the analysis to proceed.</p></dd>


<dt>max_score, min_score</dt>
<dd><p>A optional numeric vector of minimum/maximum boundaries
to clip scores for each set.</p></dd>


<dt>psuedocount</dt>
<dd><p>Psuedocount (pc) is used for rescaling set scores:
<code>(score - min_score + pc)/(max_score - min_score +pc)</code>; this is needed to
prevent division by 0 if <code>max_score==min_score</code> (in this case, all scores
for items in set will be 1, which is equivalent to standard GSEA); it also allows
users to adjust weights for scores that are close to the minimum for the scores in
the set (unless min_score==max_score): as psuedocount value approaches 0, scaled
minimum scores also approach 0; as psuedocount approaches infinity, scaled minimum
scores approach the scaled maximum scores (which equal 1); this value must be
larger than 0.</p></dd>


<dt>perms</dt>
<dd><p>The number of permutations.</p></dd>


<dt>p</dt>
<dd><p>The exponential scaling factor of the phenotype score (second column in
<code>input_df</code>).</p></dd>


<dt>q</dt>
<dd><p>The exponential scaling factor of the likelihood score (weights).</p></dd>


<dt>nThreads</dt>
<dd><p>The number of threads to use in calculating permutaions.</p></dd>


<dt>rng_seed</dt>
<dd><p>Random seed.</p></dd>


<dt>fork</dt>
<dd><p>A boolean. Whether pass "fork" to <code>type</code> parameter of
<code>makeCluster</code> on Unix-like machines.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of <code>Enrichment_Results</code>, <code>Items_in_Set</code> and <code>Running_Sums</code>.</p><dl><dt>Enrichment_Results</dt>
<dd><p>A data frame with row names of gene set and columns of
 "ES", "NES", "p_val", "fdr".</p></dd>

 <dt>Items_in_Set</dt>
<dd><p>A list of one-column data frames. Describes genes and their
 ranks in each set.</p></dd>

 <dt>Running_Sums</dt>
<dd><p>Running sum scores along genes sorted by ranked scores,
 with gene sets as columns.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The formula for weighting is as follows
$$\frac{s_{j}^{q}|r_{j}|^{p}}{\sum s^{q}|r|^{p}}$$
Where r is log ratio score, s is likelihood score, j is the index of the gene.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Eric Jaehnig</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jing Wang, John Elizarraras, Yuxing Liao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

